{"ast":null,"code":"import React, { useState } from 'react';\nimport { useNavigate, Link } from 'react-router-dom';\nimport { Container, Paper, TextField, Button, Typography, Box, Alert, CircularProgress, Divider, useTheme } from '@mui/material';\nimport { Email, Lock } from '@mui/icons-material';\nimport { useAuth } from '../contexts/AuthContext';\nimport axios from 'axios';\n\n// const Login = () => {\n//   const navigate = useNavigate();\n//   const theme = useTheme();\n//   const { login, loading, error, clearError } = useAuth();\n\n//   const [formData, setFormData] = useState({\n//     email: '',\n//     password: '',\n//   });\n\n//   const [formErrors, setFormErrors] = useState({});\n\n//   // Simple validation function\n//   const validateForm = () => {\n//     const errors = {};\n\n//     if (!formData.email) {\n//       errors.email = 'Email is required';\n//     } else if (!/\\S+@\\S+\\.\\S+/.test(formData.email)) {\n//       errors.email = 'Email is invalid';\n//     }\n\n//     if (!formData.password) {\n//       errors.password = 'Password is required';\n//     } else if (formData.password.length < 6) {\n//       errors.password = 'Password must be at least 6 characters';\n//     }\n\n//     setFormErrors(errors);\n//     return Object.keys(errors).length === 0;\n//   };\n\n//   // Handle input changes\n//   const handleChange = (e) => {\n//     const { name, value } = e.target;\n//     setFormData(prev => ({\n//       ...prev,\n//       [name]: value,\n//     }));\n\n//     // Clear errors when user starts typing\n//     if (formErrors[name]) {\n//       setFormErrors(prev => ({\n//         ...prev,\n//         [name]: '',\n//       }));\n//     }\n\n//     // Clear authentication error when user starts typing\n//     if (error) {\n//       clearError();\n//     }\n//   };\n\n//   // Manual login function - NO AUTO-ANYTHING\n//   // Replace the existing handleManualLogin with this\n//   const handleManualLogin = async () => {\n//     console.log('Manual login button clicked');\n\n//     if (!validateForm()) {\n//       console.log('Validation failed');\n//       return;\n//     }\n\n//     console.log('Starting login with:', formData.email);\n\n//     try {\n//       // Call your backend login endpoint\n//       const response = await axios.post('http://localhost:8081/api/auth/login', {\n//         email: formData.email,\n//         password: formData.password,\n//       });\n\n//       // Assuming your backend returns something like:\n//       // { token: \"eyJhbGciOi...\", user: { id: 1, name: \"...\", email: \"...\", role: \"USER\" } }\n//       const { token, user } = response.data;\n\n//       // Save to localStorage ‚Üí this is what your api.js interceptor needs!\n//       localStorage.setItem('token', token);\n//       localStorage.setItem('user', JSON.stringify(user));\n\n//       console.log('Login successful! Token saved:', token.substring(0, 20) + '...');\n\n//       // Optional: also save role/name separately if you use them elsewhere\n//       // localStorage.setItem('userRole', user.role);\n//       // localStorage.setItem('userName', user.name);\n\n//       // Show success (you can remove alert later and use a toast)\n//       alert(`Login successful! Welcome ${user?.name || 'User'}!`);\n\n//       // Reset form\n//       setFormData({ email: '', password: '' });\n//       setFormErrors({});\n\n//       // Redirect based on role (your existing logic)\n//       if (user?.role === 'ADMIN') {\n//         navigate('/admin/dashboard');\n//       } else if (user?.role === 'VENDOR') {\n//         navigate('/vendor/dashboard');\n//       } else {\n//         navigate('/meal-planner'); // or '/dashboard' if that's where SimpleUserDashboard lives\n//       }\n//     } catch (err) {\n//       console.error('Login error:', err);\n//       const errorMsg =\n//         err.response?.data?.message ||\n//         err.response?.data?.error ||\n//         'Login failed. Please check your credentials.';\n\n//       setError(errorMsg); // Use your existing error state\n//       alert(errorMsg);    // Or replace with better UI feedback\n//     }\n//   };\n\n//   return (\n//     <Container component=\"main\" maxWidth=\"sm\">\n//       <Box\n//         sx={{\n//           minHeight: '100vh',\n//           display: 'flex',\n//           flexDirection: 'column',\n//           justifyContent: 'center',\n//           py: 4,\n//         }}\n//       >\n//         <Paper\n//           elevation={10}\n//           sx={{\n//             p: 4,\n//             display: 'flex',\n//             flexDirection: 'column',\n//             alignItems: 'center',\n//             borderRadius: 3,\n//           }}\n//         >\n//           {/* Logo and Title */}\n//           <Box sx={{ textAlign: 'center', mb: 3 }}>\n//             <Typography variant=\"h3\" color=\"primary.main\" fontWeight=\"bold\">\n//               üçΩÔ∏è MealBasket\n//             </Typography>\n//             <Typography variant=\"h5\" color=\"text.secondary\" sx={{ mt: 1 }}>\n//               Sign in to your account\n//             </Typography>\n//           </Box>\n\n//           {/* Error Alert */}\n//           {error && (\n//             <Alert severity=\"error\" sx={{ width: '100%', mb: 2 }}>\n//               {error}\n//             </Alert>\n//           )}\n\n//           {/* Login Form - NO onSubmit, NO auto-anything */}\n//           <Box sx={{ width: '100%' }}>\n//             <TextField\n//               margin=\"normal\"\n//               required\n//               fullWidth\n//               id=\"email\"\n//               label=\"Email Address\"\n//               name=\"email\"\n//               autoComplete=\"email\"\n//               autoFocus\n//               value={formData.email}\n//               onChange={handleChange}\n//               error={!!formErrors.email}\n//               helperText={formErrors.email}\n//               InputProps={{\n//                 startAdornment: <Email sx={{ mr: 1, color: 'action.active' }} />,\n//               }}\n//             />\n\n//             <TextField\n//               margin=\"normal\"\n//               required\n//               fullWidth\n//               name=\"password\"\n//               label=\"Password\"\n//               type=\"password\"\n//               id=\"password\"\n//               autoComplete=\"current-password\"\n//               value={formData.password}\n//               onChange={handleChange}\n//               error={!!formErrors.password}\n//               helperText={formErrors.password}\n//               InputProps={{\n//                 startAdornment: <Lock sx={{ mr: 1, color: 'action.active' }} />,\n//               }}\n//             />\n\n//             {/* MANUAL LOGIN BUTTON - NO AUTO-CLICK */}\n//             <Button\n//               type=\"button\"\n//               fullWidth\n//               variant=\"contained\"\n//               size=\"large\"\n//               disabled={loading}\n//               onClick={handleManualLogin}\n//               sx={{ mt: 3, mb: 2, py: 1.5 }}\n//             >\n//               {loading ? (\n//                 <CircularProgress size={24} color=\"inherit\" />\n//               ) : (\n//                 'üîë Sign In'\n//               )}\n//             </Button>\n\n//             <Box sx={{ textAlign: 'center' }}>\n//               <Link to=\"/forgot-password\" style={{ textDecoration: 'none' }}>\n//                 <Typography variant=\"body2\" color=\"primary.main\">\n//                   Forgot your password?\n//                 </Typography>\n//               </Link>\n//             </Box>\n//           </Box>\n\n//           <Divider sx={{ width: '100%', my: 3 }}>\n//             <Typography variant=\"body2\" color=\"text.secondary\">\n//               OR\n//             </Typography>\n//           </Divider>\n\n//           {/* Register Link */}\n//           <Box sx={{ textAlign: 'center', width: '100%' }}>\n//             <Typography variant=\"body2\" color=\"text.secondary\">\n//               Don't have an account?{' '}\n//               <Link to=\"/register\" style={{ color: theme.palette.primary.main, fontWeight: 'bold' }}>\n//                 Sign Up\n//               </Link>\n//             </Typography>\n//           </Box>\n\n//           {/* Demo Account Info */}\n//           <Alert\n//             severity=\"info\"\n//             sx={{ mt: 3, width: '100%' }}\n//             title=\"Demo Account\"\n//           >\n//             <Typography variant=\"body2\">\n//               <strong>Demo User:</strong> user@example.com / password123<br />\n//               <strong>Demo Admin:</strong> admin@example.com / admin123\n//             </Typography>\n//           </Alert>\n//         </Paper>\n//       </Box>\n//     </Container>\n//   );\n// };\n\nexport default Login;","map":{"version":3,"names":["React","useState","useNavigate","Link","Container","Paper","TextField","Button","Typography","Box","Alert","CircularProgress","Divider","useTheme","Email","Lock","useAuth","axios","Login"],"sources":["/home/arbinlama/6semProject/Mealbasket1/react-frontend/src/pages/Login.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { useNavigate, Link } from 'react-router-dom';\nimport {\n  Container,\n  Paper,\n  TextField,\n  Button,\n  Typography,\n  Box,\n  Alert,\n  CircularProgress,\n  Divider,\n  useTheme,\n} from '@mui/material';\nimport {\n  Email,\n  Lock,\n} from '@mui/icons-material';\nimport { useAuth } from '../contexts/AuthContext';\nimport axios from 'axios'\n\n// const Login = () => {\n//   const navigate = useNavigate();\n//   const theme = useTheme();\n//   const { login, loading, error, clearError } = useAuth();\n\n//   const [formData, setFormData] = useState({\n//     email: '',\n//     password: '',\n//   });\n\n//   const [formErrors, setFormErrors] = useState({});\n\n//   // Simple validation function\n//   const validateForm = () => {\n//     const errors = {};\n\n//     if (!formData.email) {\n//       errors.email = 'Email is required';\n//     } else if (!/\\S+@\\S+\\.\\S+/.test(formData.email)) {\n//       errors.email = 'Email is invalid';\n//     }\n\n//     if (!formData.password) {\n//       errors.password = 'Password is required';\n//     } else if (formData.password.length < 6) {\n//       errors.password = 'Password must be at least 6 characters';\n//     }\n\n//     setFormErrors(errors);\n//     return Object.keys(errors).length === 0;\n//   };\n\n//   // Handle input changes\n//   const handleChange = (e) => {\n//     const { name, value } = e.target;\n//     setFormData(prev => ({\n//       ...prev,\n//       [name]: value,\n//     }));\n\n//     // Clear errors when user starts typing\n//     if (formErrors[name]) {\n//       setFormErrors(prev => ({\n//         ...prev,\n//         [name]: '',\n//       }));\n//     }\n\n//     // Clear authentication error when user starts typing\n//     if (error) {\n//       clearError();\n//     }\n//   };\n\n//   // Manual login function - NO AUTO-ANYTHING\n//   // Replace the existing handleManualLogin with this\n//   const handleManualLogin = async () => {\n//     console.log('Manual login button clicked');\n\n//     if (!validateForm()) {\n//       console.log('Validation failed');\n//       return;\n//     }\n\n//     console.log('Starting login with:', formData.email);\n\n//     try {\n//       // Call your backend login endpoint\n//       const response = await axios.post('http://localhost:8081/api/auth/login', {\n//         email: formData.email,\n//         password: formData.password,\n//       });\n\n//       // Assuming your backend returns something like:\n//       // { token: \"eyJhbGciOi...\", user: { id: 1, name: \"...\", email: \"...\", role: \"USER\" } }\n//       const { token, user } = response.data;\n\n//       // Save to localStorage ‚Üí this is what your api.js interceptor needs!\n//       localStorage.setItem('token', token);\n//       localStorage.setItem('user', JSON.stringify(user));\n\n//       console.log('Login successful! Token saved:', token.substring(0, 20) + '...');\n\n//       // Optional: also save role/name separately if you use them elsewhere\n//       // localStorage.setItem('userRole', user.role);\n//       // localStorage.setItem('userName', user.name);\n\n//       // Show success (you can remove alert later and use a toast)\n//       alert(`Login successful! Welcome ${user?.name || 'User'}!`);\n\n//       // Reset form\n//       setFormData({ email: '', password: '' });\n//       setFormErrors({});\n\n//       // Redirect based on role (your existing logic)\n//       if (user?.role === 'ADMIN') {\n//         navigate('/admin/dashboard');\n//       } else if (user?.role === 'VENDOR') {\n//         navigate('/vendor/dashboard');\n//       } else {\n//         navigate('/meal-planner'); // or '/dashboard' if that's where SimpleUserDashboard lives\n//       }\n//     } catch (err) {\n//       console.error('Login error:', err);\n//       const errorMsg =\n//         err.response?.data?.message ||\n//         err.response?.data?.error ||\n//         'Login failed. Please check your credentials.';\n\n//       setError(errorMsg); // Use your existing error state\n//       alert(errorMsg);    // Or replace with better UI feedback\n//     }\n//   };\n\n//   return (\n//     <Container component=\"main\" maxWidth=\"sm\">\n//       <Box\n//         sx={{\n//           minHeight: '100vh',\n//           display: 'flex',\n//           flexDirection: 'column',\n//           justifyContent: 'center',\n//           py: 4,\n//         }}\n//       >\n//         <Paper\n//           elevation={10}\n//           sx={{\n//             p: 4,\n//             display: 'flex',\n//             flexDirection: 'column',\n//             alignItems: 'center',\n//             borderRadius: 3,\n//           }}\n//         >\n//           {/* Logo and Title */}\n//           <Box sx={{ textAlign: 'center', mb: 3 }}>\n//             <Typography variant=\"h3\" color=\"primary.main\" fontWeight=\"bold\">\n//               üçΩÔ∏è MealBasket\n//             </Typography>\n//             <Typography variant=\"h5\" color=\"text.secondary\" sx={{ mt: 1 }}>\n//               Sign in to your account\n//             </Typography>\n//           </Box>\n\n//           {/* Error Alert */}\n//           {error && (\n//             <Alert severity=\"error\" sx={{ width: '100%', mb: 2 }}>\n//               {error}\n//             </Alert>\n//           )}\n\n//           {/* Login Form - NO onSubmit, NO auto-anything */}\n//           <Box sx={{ width: '100%' }}>\n//             <TextField\n//               margin=\"normal\"\n//               required\n//               fullWidth\n//               id=\"email\"\n//               label=\"Email Address\"\n//               name=\"email\"\n//               autoComplete=\"email\"\n//               autoFocus\n//               value={formData.email}\n//               onChange={handleChange}\n//               error={!!formErrors.email}\n//               helperText={formErrors.email}\n//               InputProps={{\n//                 startAdornment: <Email sx={{ mr: 1, color: 'action.active' }} />,\n//               }}\n//             />\n\n//             <TextField\n//               margin=\"normal\"\n//               required\n//               fullWidth\n//               name=\"password\"\n//               label=\"Password\"\n//               type=\"password\"\n//               id=\"password\"\n//               autoComplete=\"current-password\"\n//               value={formData.password}\n//               onChange={handleChange}\n//               error={!!formErrors.password}\n//               helperText={formErrors.password}\n//               InputProps={{\n//                 startAdornment: <Lock sx={{ mr: 1, color: 'action.active' }} />,\n//               }}\n//             />\n\n//             {/* MANUAL LOGIN BUTTON - NO AUTO-CLICK */}\n//             <Button\n//               type=\"button\"\n//               fullWidth\n//               variant=\"contained\"\n//               size=\"large\"\n//               disabled={loading}\n//               onClick={handleManualLogin}\n//               sx={{ mt: 3, mb: 2, py: 1.5 }}\n//             >\n//               {loading ? (\n//                 <CircularProgress size={24} color=\"inherit\" />\n//               ) : (\n//                 'üîë Sign In'\n//               )}\n//             </Button>\n\n//             <Box sx={{ textAlign: 'center' }}>\n//               <Link to=\"/forgot-password\" style={{ textDecoration: 'none' }}>\n//                 <Typography variant=\"body2\" color=\"primary.main\">\n//                   Forgot your password?\n//                 </Typography>\n//               </Link>\n//             </Box>\n//           </Box>\n\n//           <Divider sx={{ width: '100%', my: 3 }}>\n//             <Typography variant=\"body2\" color=\"text.secondary\">\n//               OR\n//             </Typography>\n//           </Divider>\n\n//           {/* Register Link */}\n//           <Box sx={{ textAlign: 'center', width: '100%' }}>\n//             <Typography variant=\"body2\" color=\"text.secondary\">\n//               Don't have an account?{' '}\n//               <Link to=\"/register\" style={{ color: theme.palette.primary.main, fontWeight: 'bold' }}>\n//                 Sign Up\n//               </Link>\n//             </Typography>\n//           </Box>\n\n//           {/* Demo Account Info */}\n//           <Alert\n//             severity=\"info\"\n//             sx={{ mt: 3, width: '100%' }}\n//             title=\"Demo Account\"\n//           >\n//             <Typography variant=\"body2\">\n//               <strong>Demo User:</strong> user@example.com / password123<br />\n//               <strong>Demo Admin:</strong> admin@example.com / admin123\n//             </Typography>\n//           </Alert>\n//         </Paper>\n//       </Box>\n//     </Container>\n//   );\n// };\n\nexport default Login;\n"],"mappings":"AAAA,OAAOA,KAAK,IAAIC,QAAQ,QAAQ,OAAO;AACvC,SAASC,WAAW,EAAEC,IAAI,QAAQ,kBAAkB;AACpD,SACEC,SAAS,EACTC,KAAK,EACLC,SAAS,EACTC,MAAM,EACNC,UAAU,EACVC,GAAG,EACHC,KAAK,EACLC,gBAAgB,EAChBC,OAAO,EACPC,QAAQ,QACH,eAAe;AACtB,SACEC,KAAK,EACLC,IAAI,QACC,qBAAqB;AAC5B,SAASC,OAAO,QAAQ,yBAAyB;AACjD,OAAOC,KAAK,MAAM,OAAO;;AAEzB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,eAAeC,KAAK","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}